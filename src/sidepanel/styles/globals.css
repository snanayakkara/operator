@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';
@import './fluent-tokens.css';
@import './utilities.css';

/* Theme System - CSS Variables */
@layer base {
  :root {
    /* Z-Index Layering */
    --z-dropdown: 999999;
    --z-modal: 999998;
    --z-tooltip: 999997;
    --z-sticky: 100;
    --z-fixed: 200;

    /* Theme colors - defaults (light theme) */
    /* These are overridden by ThemeManager at runtime */
    --color-bg-primary: rgb(255, 255, 255);
    --color-bg-secondary: rgb(249, 250, 251);
    --color-bg-tertiary: rgb(243, 244, 246);
    --color-bg-elevated: rgb(255, 255, 255);
    --color-bg-overlay: rgba(0, 0, 0, 0.5);

    --color-text-primary: rgb(17, 24, 39);
    --color-text-secondary: rgb(75, 85, 99);
    --color-text-tertiary: rgb(156, 163, 175);
    --color-text-inverse: rgb(255, 255, 255);
    --color-text-link: rgb(37, 99, 235);

    --color-border-primary: rgb(229, 231, 235);
    --color-border-secondary: rgb(243, 244, 246);
    --color-border-focus: rgb(59, 130, 246);

    --color-surface-primary: rgb(255, 255, 255);
    --color-surface-secondary: rgb(249, 250, 251);
    --color-surface-tertiary: rgb(243, 244, 246);
    --color-surface-elevated: rgb(255, 255, 255);

    --color-accent-emerald: rgb(16, 185, 129);
    --color-accent-blue: rgb(59, 130, 246);
    --color-accent-purple: rgb(168, 85, 247);
    --color-accent-rose: rgb(244, 63, 94);
    --color-accent-amber: rgb(245, 158, 11);

    --color-state-recording: rgb(239, 68, 68);
    --color-state-transcribing: rgb(59, 130, 246);
    --color-state-ai-analysis: rgb(168, 85, 247);
    --color-state-generation: rgb(16, 185, 129);
    --color-state-completed: rgb(20, 184, 166);
    --color-state-needs-review: rgb(245, 158, 11);
    --color-state-error: rgb(244, 63, 94);
  }

  /* Dark theme overrides (applied by .dark class) */
  .dark {
    --color-bg-primary: rgb(17, 24, 39);
    --color-bg-secondary: rgb(31, 41, 55);
    --color-bg-tertiary: rgb(55, 65, 81);
    --color-bg-elevated: rgb(31, 41, 55);
    --color-bg-overlay: rgba(0, 0, 0, 0.75);

    --color-text-primary: rgb(243, 244, 246);
    --color-text-secondary: rgb(209, 213, 219);
    --color-text-tertiary: rgb(156, 163, 175);
    --color-text-inverse: rgb(17, 24, 39);
    --color-text-link: rgb(96, 165, 250);

    --color-border-primary: rgb(75, 85, 99);
    --color-border-secondary: rgb(55, 65, 81);
    --color-border-focus: rgb(96, 165, 250);

    --color-surface-primary: rgb(31, 41, 55);
    --color-surface-secondary: rgb(55, 65, 81);
    --color-surface-tertiary: rgb(75, 85, 99);
    --color-surface-elevated: rgb(55, 65, 81);

    --color-accent-emerald: rgb(52, 211, 153);
    --color-accent-blue: rgb(96, 165, 250);
    --color-accent-purple: rgb(192, 132, 252);
    --color-accent-rose: rgb(251, 113, 133);
    --color-accent-amber: rgb(251, 191, 36);

    --color-state-recording: rgb(248, 113, 113);
    --color-state-transcribing: rgb(96, 165, 250);
    --color-state-ai-analysis: rgb(192, 132, 252);
    --color-state-generation: rgb(52, 211, 153);
    --color-state-completed: rgb(45, 212, 191);
    --color-state-needs-review: rgb(251, 191, 36);
    --color-state-error: rgb(251, 113, 133);
  }
}

/* Extension-level dark mode (toggled via quick action) */
html.operator-extension-dark,
body.operator-extension-dark {
  background-color: #0b1220;
  color: #e5e7eb;
  color-scheme: dark;
}

.operator-extension-dark .bg-white,
.operator-extension-dark .bg-gray-50,
.operator-extension-dark .bg-gray-100 {
  background-color: #0f172a !important;
}

/* Override translucent light surfaces in dark mode */
.operator-extension-dark [class*="bg-white/"],
.operator-extension-dark [class*="bg-gray-50/"],
.operator-extension-dark [class*="bg-gray-100/"] {
  background-color: #0f172a !important;
}

.operator-extension-dark [class*="border-gray-100"],
.operator-extension-dark [class*="border-gray-200"],
.operator-extension-dark [class*="border-gray-300"] {
  border-color: #1f2937 !important;
}

.operator-extension-dark .operator-results-container {
  background-color: #0f172a !important;
  border-color: #1f2937 !important;
  color: #e5e7eb;
  box-shadow: 0 14px 40px rgba(0, 0, 0, 0.45) !important;
}

.operator-extension-dark .operator-results-header {
  background: linear-gradient(135deg, #0b1220, #0f172a) !important;
  border-color: #1f2937 !important;
}

.operator-extension-dark .operator-results-container .bg-white,
.operator-extension-dark .operator-results-container .bg-gray-50,
.operator-extension-dark .operator-results-container .bg-gray-100,
.operator-extension-dark .operator-results-container .bg-white\/80,
.operator-extension-dark .operator-results-container .bg-white\/90,
.operator-extension-dark .operator-results-container .bg-white\/95,
.operator-extension-dark .operator-results-container [class*="bg-white/"],
.operator-extension-dark .operator-results-container [class*="bg-gray-50/"],
.operator-extension-dark .operator-results-container [class*="bg-gray-100/"] {
  background-color: #0f172a !important;
}

.operator-extension-dark .operator-results-container .border-gray-100,
.operator-extension-dark .operator-results-container .border-gray-200,
.operator-extension-dark .operator-results-container .border-gray-300,
.operator-extension-dark .operator-results-container [class*="border-gray-100"],
.operator-extension-dark .operator-results-container [class*="border-gray-200"],
.operator-extension-dark .operator-results-container [class*="border-gray-300"] {
  border-color: #1f2937 !important;
}

.operator-extension-dark .operator-results-container .text-gray-900,
.operator-extension-dark .operator-results-container .text-gray-800 {
  color: #f3f4f6 !important;
}

.operator-extension-dark .operator-results-container .text-gray-700,
.operator-extension-dark .operator-results-container .text-gray-600,
.operator-extension-dark .operator-results-container .text-gray-500,
.operator-extension-dark .operator-results-container .text-gray-400,
.operator-extension-dark .operator-results-container .text-gray-300,
.operator-extension-dark .operator-results-container .text-gray-200 {
  color: #cbd5e1 !important;
}

.operator-extension-dark .bg-surface-primary,
.operator-extension-dark .bg-surface-secondary,
.operator-extension-dark .bg-surface-tertiary,
.operator-extension-dark .bg-surface-elevated,
.operator-extension-dark #results-section {
  background-color: #0b1220 !important;
}

.operator-extension-dark .text-gray-700,
.operator-extension-dark .text-gray-600,
.operator-extension-dark .text-gray-500,
.operator-extension-dark .text-gray-400,
.operator-extension-dark .text-gray-300,
.operator-extension-dark .text-gray-200 {
  color: #cbd5e1 !important;
}

.operator-extension-dark .dot-grid-background-light {
  background-color: #0b1220;
  background-image: radial-gradient(circle, rgba(255, 255, 255, 0.06) 1px, transparent 1px);
}

.operator-extension-dark .border-gray-100,
.operator-extension-dark .border-gray-200,
.operator-extension-dark .border-gray-300 {
  border-color: #1f2937 !important;
}

.operator-extension-dark .text-gray-900,
.operator-extension-dark .text-gray-800 {
  color: #f3f4f6 !important;
}

.operator-extension-dark .text-gray-700,
.operator-extension-dark .text-gray-600 {
  color: #cbd5e1 !important;
}

.operator-extension-dark .dot-grid-background-light {
  background-color: #0b1220;
  background-image: radial-gradient(circle, rgba(255, 255, 255, 0.06) 1px, transparent 1px);
}

.operator-extension-dark .glass {
  background: rgba(17, 24, 39, 0.35);
  border-color: rgba(255, 255, 255, 0.06);
}

/* Fluent Design Components */
@layer components {
  /* Base surfaces - stroke separation only */
  .surface-primary {
    @apply bg-surface-primary border border-line-primary;
  }

  /* Pill-shaped interactive elements */
  .pill-button {
    @apply surface-primary rounded-fluent-sm px-4 py-2 text-ink-primary;
    @apply focus:ring-2 focus:ring-accent-violet/20;
    @apply transition-all duration-150 cursor-pointer select-none;
    border: 1px solid theme('colors.line.primary');
  }

  .pill-button:hover {
    @apply bg-surface-tertiary;
    border-color: theme('colors.line.secondary');
  }

  .pill-button:active {
    @apply bg-surface-subtle;
  }

  /* Pill inputs */
  .pill-input {
    @apply surface-primary rounded-fluent-sm px-4 py-2 text-ink-primary;
    @apply border border-line-primary placeholder-ink-tertiary;
    @apply focus:ring-2 focus:ring-accent-violet/20 focus:border-accent-violet/30;
    @apply transition-all duration-150;
  }

  /* Cards with Fluent stroke separation */
  .card-primary {
    @apply surface-primary rounded-fluent-sm p-4;
    border: 1px solid theme('colors.line.primary');
  }

  .card-primary:hover {
    border-color: theme('colors.line.secondary');
  }

  /* Fluent button patterns */
  .mono-button {
    @apply bg-surface-primary border border-line-primary text-ink-primary
           hover:bg-surface-tertiary hover:border-line-secondary
           transition-all duration-200 ease-out
           font-medium rounded-fluent-sm px-4 py-2 cursor-pointer select-none;
  }

  .mono-button-secondary {
    @apply bg-transparent border border-line-primary text-ink-secondary
           hover:bg-surface-tertiary hover:border-line-secondary
           transition-all duration-200 ease-out
           rounded-fluent-sm px-3 py-1.5 cursor-pointer select-none;
  }

  .mono-button-icon {
    @apply bg-transparent text-ink-secondary hover:text-ink-primary hover:bg-surface-tertiary
           transition-all duration-200 ease-out
           rounded-fluent-sm p-2 cursor-pointer select-none;
  }

  .mono-input {
    @apply bg-surface-primary border border-line-primary text-ink-primary
           placeholder-ink-disabled rounded-fluent-sm px-3 py-2
           focus:border-2 focus:border-accent-violet
           transition-all duration-200 ease-out;
  }

  .mono-card {
    @apply bg-surface-primary border border-line-primary rounded-fluent-sm
           transition-all duration-300 ease-out
           p-4;
  }

  .mono-card:hover {
    border-color: theme('colors.line.secondary');
  }

  /* Legacy class mapping - point to Fluent components */
  .glass-button {
    @apply mono-button-icon;
  }

  .glass-input {
    @apply mono-input;
  }

  .glass-card {
    @apply fluent-card;
  }

  /* Dropdown and Portal Components */
  .dropdown-portal {
    z-index: var(--z-dropdown) !important;
  }

  .dropdown-menu {
    z-index: var(--z-dropdown) !important;
    position: fixed !important;
  }

  .modal-overlay {
    z-index: var(--z-modal) !important;
  }

  /* Ensure no element can override critical z-index values */
  .dropdown-portal * {
    max-height: calc(100vh - 32px) !important;
  }
  
  /* Fluent Workflow Cards - Stroke-based separation */
  .workflow-card {
    @apply surface-primary text-ink-primary rounded-fluent-sm;
    border: 1px solid theme('colors.line.primary');
  }

  .workflow-card:hover {
    border-color: theme('colors.line.secondary');
  }

  .workflow-card.active {
    border: 2px solid theme('colors.accent.violet');
  }

  /* Legacy cards for gradual migration */
  .procedure-card {
    @apply workflow-card;
  }

  .documentation-card {
    @apply workflow-card;
  }

  .investigation-card {
    @apply workflow-card;
  }

  /* Fluent Primary Action Buttons - Stroke-based */
  .btn-primary {
    @apply bg-ink-primary text-surface-primary rounded-fluent-sm px-4 py-2;
    @apply hover:bg-ink-secondary focus:ring-2 focus:ring-ink-primary/20;
    @apply transition-all duration-150;
    border: 1px solid theme('colors.ink.primary');
  }

  /* Secondary buttons - Fluent pattern */
  .btn-secondary {
    @apply surface-primary text-ink-primary rounded-fluent-sm px-4 py-2;
    @apply hover:bg-surface-tertiary focus:ring-2 focus:ring-accent-violet/20;
    @apply transition-all duration-150;
    border: 1px solid theme('colors.line.primary');
  }

  .btn-secondary:hover {
    border-color: theme('colors.line.secondary');
  }

  /* Legacy buttons for gradual migration */
  .btn-procedure {
    @apply btn-primary;
  }

  .btn-documentation {
    @apply btn-primary;
  }

  .btn-investigation {
    @apply btn-primary;
  }

  /* Fluent Outline Buttons - Accent on interaction */
  .btn-outline {
    @apply surface-primary text-ink-secondary rounded-fluent-sm px-4 py-2;
    @apply hover:text-ink-primary hover:bg-surface-tertiary;
    @apply focus:ring-2 focus:ring-accent-violet/20;
    @apply transition-all duration-150;
    border: 1px solid theme('colors.line.primary');
  }

  .btn-outline:hover {
    border-color: theme('colors.line.secondary');
  }

  .btn-outline.accent-emerald:hover {
    border-color: theme('colors.accent.emerald');
  }

  .btn-outline.accent-violet:hover {
    border-color: theme('colors.accent.violet');
  }

  .btn-outline.accent-amber:hover {
    border-color: theme('colors.accent.amber');
  }

  /* Legacy outline buttons */
  .btn-procedure-outline {
    @apply btn-outline accent-amber;
  }

  .btn-documentation-outline {
    @apply btn-outline accent-violet;
  }

  .btn-investigation-outline {
    @apply btn-outline accent-emerald;
  }
  
  /* Legacy Components (Updated) */
  .medical-gradient {
    @apply bg-gradient-to-br from-blue-50 to-indigo-50;
  }
  
  .summary-card {
    background: var(--documentation-light);
    border-color: var(--documentation-border);
  }
  
  .letter-card {
    background: var(--investigation-light);
    border-color: var(--investigation-border);
  }
  
  .recording-pulse {
    @apply animate-pulse bg-red-50 border-red-200;
  }
  
  .processing-spin {
    @apply animate-spin border-2 border-gray-200 border-t-blue-600;
  }

  /* Peak-End Animation Utilities with GPU Acceleration */
  .btn-success-animation {
    animation: success-bounce 0.6s ease-out;
    will-change: transform;
    transform: translate3d(0, 0, 0);
  }

  .btn-press-animation {
    animation: gentle-press 0.15s ease-out;
    will-change: transform;
    transform: translate3d(0, 0, 0);
  }

  .btn-hover-enhanced {
    transition: all 0.2s ease-out;
    will-change: transform;
    transform: translate3d(0, 0, 0);
  }

  .btn-hover-enhanced:hover {
    transform: translate3d(0, -1px, 0) scale(1.02);
  }

  .completion-celebration {
    animation: completion-glow 0.8s ease-out;
    will-change: transform, box-shadow;
    transform: translate3d(0, 0, 0);
  }

  .checkmark-appear {
    animation: checkmark-bounce 0.5s ease-out;
    will-change: transform, opacity;
    transform: translate3d(0, 0, 0);
  }

  .content-slide-in {
    animation: slide-in 0.4s ease-out;
    will-change: transform, opacity;
    transform: translate3d(0, 0, 0);
  }

  /* Fluent Button Interactions - Minimal, stroke-based */
  .btn-micro-press:active {
    transform: scale(0.98);
    transition: transform 0.1s ease-out;
  }

  .btn-micro-hover {
    transition: background-color 0.2s ease-out, border-color 0.2s ease-out;
  }

  .btn-micro-hover:hover {
    background-color: var(--fluent-surface-tertiary);
  }

  /* Fluent Recording State - Accent stroke instead of glow */
  .recording-glow {
    border: 2px solid theme('colors.accent.red');
    animation: recording-pulse-fluent 2s infinite;
  }

  /* Fluent Record Panel Animations - Minimal motion */
  .record-button-idle {
    animation: record-breathing-fluent 3s ease-in-out infinite;
  }

  .record-button-recording {
    animation: record-recording-pulse-fluent 2s ease-in-out infinite;
  }

  .record-card {
    animation: record-card-appear-fluent 200ms ease-out;
    transform-origin: top center;
  }
}

@layer utilities {
  .icon-compact {
    width: 1rem;
    height: 1rem;
    display: inline-block;
    vertical-align: middle;
  }

  /* ===== Standardized Shadow Utilities (Sera UI-inspired) ===== */
  .shadow-card {
    box-shadow: var(--shadow-card, 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.04));
  }

  .shadow-card-hover {
    box-shadow: var(--shadow-card-hover, 0 4px 12px rgba(0, 0, 0, 0.1));
  }

  .shadow-modal {
    box-shadow: var(--shadow-modal, 0 20px 40px rgba(0, 0, 0, 0.15));
  }

  /* ===== Standardized Border Radius Utilities ===== */
  .rounded-button {
    border-radius: var(--radius-button, 8px);
  }

  .rounded-card {
    border-radius: var(--radius-card, 12px);
  }

  .rounded-modal {
    border-radius: var(--radius-modal, 16px);
  }

  /* ===== Primary Accent Utilities ===== */
  .bg-accent-primary {
    background-color: var(--fluent-accent-primary, #8B5CF6);
  }

  .bg-accent-primary-hover {
    background-color: var(--fluent-accent-primary-hover, #7C3AED);
  }

  .bg-accent-primary-subtle {
    background-color: var(--fluent-accent-primary-subtle, rgba(139, 92, 246, 0.08));
  }

  .text-accent-primary {
    color: var(--fluent-accent-primary, #8B5CF6);
  }

  .border-accent-primary {
    border-color: var(--fluent-accent-primary, #8B5CF6);
  }

  .ring-accent-primary {
    --tw-ring-color: var(--fluent-accent-primary-ring, rgba(139, 92, 246, 0.25));
  }

  /* Focus ring utility for primary accent */
  .focus-ring-primary:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--fluent-surface-primary, #fff), 0 0 0 4px var(--fluent-accent-primary, #8B5CF6);
  }

}

@keyframes complete-pop {
  0% {
    transform: scale(0.96) rotate(-1deg);
    opacity: 0.6;
    filter: hue-rotate(0deg);
  }
  60% {
    transform: scale(1.05) rotate(1deg);
    opacity: 1;
    filter: hue-rotate(10deg);
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
    filter: hue-rotate(0deg);
  }
}

.animate-complete-pop {
  animation: complete-pop 220ms ease-out;
}

@media (prefers-reduced-motion: reduce) {
  .animate-complete-pop {
    animation: none;
    transform: scale(1) rotate(0deg);
  }
}

/* Semantic Medical Color System */
:root {
  /* Medical Procedure Workflows (TAVI, PCI, Angiogram) */
  --procedure-primary: theme('colors.red.600');
  --procedure-secondary: theme('colors.red.500');
  --procedure-light: theme('colors.red.50');
  --procedure-border: theme('colors.red.200');
  --procedure-text: theme('colors.red.900');
  
  /* Documentation Workflows (Quick Letter, Consultation) */
  --documentation-primary: theme('colors.blue.600');
  --documentation-secondary: theme('colors.blue.500');
  --documentation-light: theme('colors.blue.50');
  --documentation-border: theme('colors.blue.200');
  --documentation-text: theme('colors.blue.900');
  
  /* Investigation Workflows (Investigation Summary) */
  --investigation-primary: theme('colors.emerald.600');
  --investigation-secondary: theme('colors.emerald.500');
  --investigation-light: theme('colors.emerald.50');
  --investigation-border: theme('colors.emerald.200');
  --investigation-text: theme('colors.emerald.900');
  
  /* System States */
  --system-success: theme('colors.green.500');
  --system-warning: theme('colors.amber.500');
  --system-error: theme('colors.red.500');
  --system-info: theme('colors.blue.500');
  
  /* Base Colors */
  --medical-text: theme('colors.gray.900');
  --medical-muted: theme('colors.gray.500');
  --medical-bg: theme('colors.white');
  --medical-surface: theme('colors.gray.50');
}

/* Global Styles */
* {
  box-sizing: border-box;
}

html, body {
  margin: 0;
  padding: 0;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  width: 420px; /* Chrome side panel width */
  min-height: 600px;
  overflow-x: hidden;
  background: theme('colors.surface.secondary'); /* Light canvas background */
  color: theme('colors.ink.primary');
}

body.canvas-page {
  width: 100% !important;
  min-height: 100vh;
  background: theme('colors.gray.100');
  color: theme('colors.ink.primary');
}

body.canvas-page #root {
  width: 100%;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.05);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.3);
}

/* Button Animations */
@keyframes button-press {
  0% { transform: scale(1); }
  50% { transform: scale(0.95); }
  100% { transform: scale(1); }
}

.btn-press {
  animation: button-press 0.15s ease-out;
}

/* Recording Animation with GPU Acceleration */
@keyframes recording-glow {
  0%, 100% { 
    box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% { 
    box-shadow: 0 0 30px rgba(239, 68, 68, 0.8);
    transform: translate3d(0, 0, 0) scale(1.02);
  }
}

.recording-glow {
  animation: recording-glow 2s ease-in-out infinite;
  will-change: transform, box-shadow;
  transform: translate3d(0, 0, 0);
}

/* Voice Activity Visualization */
@keyframes voice-activity {
  0%, 100% { height: 4px; opacity: 0.3; }
  50% { height: 20px; opacity: 1; }
}

.voice-bar {
  animation: voice-activity 0.5s ease-in-out infinite;
}

.voice-bar:nth-child(2) { animation-delay: 0.1s; }
.voice-bar:nth-child(3) { animation-delay: 0.2s; }
.voice-bar:nth-child(4) { animation-delay: 0.3s; }
.voice-bar:nth-child(5) { animation-delay: 0.4s; }

/* Loading States */
@keyframes pulse-glow {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

.pulse-glow {
  animation: pulse-glow 1.5s ease-in-out infinite;
}

/* Peak-End Success Animations with GPU Acceleration */
@keyframes success-bounce {
  0% { transform: translate3d(0, 0, 0) scale(1); }
  50% { transform: translate3d(0, 0, 0) scale(1.05); }
  100% { transform: translate3d(0, 0, 0) scale(1); }
}

@keyframes gentle-press {
  0% { transform: translate3d(0, 0, 0) scale(1); }
  50% { 
    transform: translate3d(0, 0, 0) scale(0.98); 
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1); 
  }
  100% { transform: translate3d(0, 0, 0) scale(1); }
}

@keyframes completion-glow {
  0% {
    box-shadow: 0 0 0 rgba(16, 185, 129, 0);
    transform: translate3d(0, 0, 0) scale(1);
    filter: hue-rotate(0deg) brightness(1);
  }
  50% {
    box-shadow: 0 0 20px rgba(20, 184, 166, 0.4);
    transform: translate3d(0, 0, 0) scale(1.02);
    filter: hue-rotate(8deg) brightness(1.05);
  }
  100% {
    box-shadow: 0 0 0 rgba(16, 185, 129, 0);
    transform: translate3d(0, 0, 0) scale(1);
    filter: hue-rotate(0deg) brightness(1);
  }
}

@keyframes checkmark-bounce {
  0% { 
    opacity: 0;
    transform: translate3d(0, 0, 0) scale(0) rotate(-45deg);
  }
  50% { 
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1.1) rotate(0deg);
  }
  100% { 
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1) rotate(0deg);
  }
}

@keyframes slide-in {
  0% { 
    opacity: 0;
    transform: translate3d(0, 10px, 0);
  }
  100% { 
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes recording-pulse {
  0%, 100% { 
    box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% { 
    box-shadow: 0 0 30px rgba(239, 68, 68, 0.6);
    transform: translate3d(0, 0, 0) scale(1.01);
  }
}

/* Record Panel Animations */
@keyframes record-breathing {
  0%, 100% { 
    transform: translate3d(0, 0, 0) scale(1);
  }
  50% { 
    transform: translate3d(0, 0, 0) scale(1.05);
  }
}

@keyframes record-recording-pulse {
  0%, 100% { 
    transform: translate3d(0, 0, 0) scale(1) rotate(0deg);
    box-shadow: 0 0 15px rgba(239, 68, 68, 0.4);
  }
  25% { 
    transform: translate3d(0, 0, 0) scale(1.08) rotate(1deg);
    box-shadow: 0 0 25px rgba(239, 68, 68, 0.6);
  }
  50% { 
    transform: translate3d(0, 0, 0) scale(1.1) rotate(0deg);
    box-shadow: 0 0 30px rgba(239, 68, 68, 0.8);
  }
  75% { 
    transform: translate3d(0, 0, 0) scale(1.08) rotate(-1deg);
    box-shadow: 0 0 25px rgba(239, 68, 68, 0.6);
  }
}

@keyframes record-card-slide-down {
  0% { 
    opacity: 0;
    transform: translateX(-50%) translateY(-20px) scale(0.95);
  }
  100% { 
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1);
  }
}

@keyframes record-card-appear {
  0% {
    opacity: 0;
    transform: translate3d(0, 0, 0) scale(0.9) translateY(-10px);
  }
  100% {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1) translateY(0);
  }
}

/* Fluent Design Keyframes - Minimal, stroke-based */
@keyframes recording-pulse-fluent {
  0%, 100% {
    border-color: theme('colors.accent.red');
    opacity: 1;
  }
  50% {
    border-color: rgba(239, 68, 68, 0.6);
    opacity: 0.8;
  }
}

@keyframes record-breathing-fluent {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.02);
  }
}

@keyframes record-recording-pulse-fluent {
  0%, 100% {
    transform: scale(1);
    border-width: 2px;
  }
  50% {
    transform: scale(1.03);
    border-width: 3px;
  }
}

@keyframes record-card-appear-fluent {
  0% {
    opacity: 0;
    transform: scale(0.95) translateY(-8px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Text Animations */
@keyframes typewriter {
  from { width: 0; }
  to { width: 100%; }
}

.typewriter {
  overflow: hidden;
  white-space: nowrap;
  animation: typewriter 2s steps(40, end);
}

/* Fluent Status Indicators - No glows, just solid colors */
.status-online {
  @apply bg-accent-emerald;
}

.status-offline {
  @apply bg-accent-red;
  animation: pulse 2s infinite;
}

.status-processing {
  @apply bg-accent-amber;
  animation: pulse 1s infinite;
}

/* Medical Report Formatting */
.medical-report {
  @apply space-y-4 text-sm leading-relaxed;
}

.medical-report h3 {
  @apply font-semibold text-gray-900 border-b border-gray-200 pb-1 mb-2;
}

.medical-report p {
  @apply text-gray-900 mb-2;
}

.medical-report ul {
  @apply list-disc list-inside space-y-1 text-gray-900;
}

.medical-report .measurement {
  @apply font-mono bg-white/10 px-1 rounded;
}

/* Responsive Design */
@media (max-width: 400px) {
  body {
    width: 100vw;
  }
  
  .glass-card {
    @apply mx-2 p-3;
  }
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* High Contrast Mode */
@media (prefers-contrast: high) {
  .glass {
    @apply border-white/50 bg-white/20;
  }
  
  .glass-button:hover {
    @apply bg-white/40;
  }
}

/* Dark Mode Support */
@media (prefers-color-scheme: dark) {
  /* Already optimized for dark theme */
}

/* Fluent Focus Styles - Clean ring system */
button:focus-visible,
input:focus-visible,
textarea:focus-visible {
  @apply outline-none ring-2 ring-accent-violet ring-offset-2;
  ring-offset-color: theme('colors.surface.secondary');
}

/* Selection Styles */
::selection {
  background: rgba(59, 130, 246, 0.2);
  color: #1f2937;
}

/* Utility Classes */
.text-shadow {
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}

/* Fluent Overlays - Solid surfaces, no blur */
.fluent-overlay-light {
  @apply bg-surface-primary border border-line-primary;
}

.fluent-overlay-medium {
  @apply bg-surface-secondary border border-line-primary;
}

.fluent-overlay-strong {
  @apply fluent-overlay;
}

/* Legacy mapping - removed backdrop blur */
.mono-overlay-light {
  @apply fluent-overlay-light;
}

.mono-overlay-medium {
  @apply fluent-overlay-medium;
}

.mono-overlay-strong {
  @apply fluent-overlay-strong;
}

.backdrop-blur-sm {
  @apply fluent-overlay-light;
}

.backdrop-blur-md {
  @apply fluent-overlay-medium;
}

.backdrop-blur-lg {
  @apply fluent-overlay-strong;
}

/* Dropdown Z-Index Fix - Enhanced */
.dropdown-container {
  position: relative;
  z-index: 1000;
  isolation: isolate;
}

.dropdown-menu {
  position: fixed;
  z-index: 999999;
  box-shadow: var(--fluent-elevation-flyout);
  transform: translateZ(0);
}

.dropdown-backdrop {
  position: fixed;
  inset: 0;
  z-index: 999998;
  background: transparent;
}

/* Prevent parent containers from creating stacking contexts */
.glass {
  isolation: auto;
  transform: none;
  position: relative;
}

.glass-card {
  position: relative;
  z-index: auto;
  isolation: auto;
  transform: none;
}

/* Force dropdown menus to appear above everything using fixed positioning */
[data-dropdown-menu] {
  position: fixed !important;
  z-index: 999999 !important;
  transform: translateZ(0) !important;
  will-change: transform;
  isolation: isolate;
  pointer-events: auto;
}

/* Ensure dropdown triggers maintain their stacking context */
[data-dropdown-trigger] {
  position: relative;
  z-index: 1000;
}

/* Special handling for dropdowns in the side panel */
.side-panel-dropdown {
  position: fixed !important;
  z-index: 999999 !important;
  max-width: 280px;
  transform: translateZ(0);
}

/* Reset any transform contexts that might interfere */
.dropdown-reset-context {
  transform: none !important;
  will-change: auto !important;
  isolation: auto !important;
}

/* Grid Layout for Side Panel */
.app-container {
  @apply bg-gray-50;
  display: grid;
  grid-template-rows: 1fr auto;
  height: 100vh;
  overflow: hidden;
}

.main-content {
  @apply overflow-y-auto;
  grid-row: 1;
}

.footer-section {
  @apply bg-white border-t border-gray-200 shadow-lg;
  grid-row: 2;
}

.footer-content {
  @apply p-4;
  max-width: 420px; /* Match sidebar width */
  margin: 0 auto;
}

/* Compact Quick Actions for footer */
.quick-actions-horizontal {
  @apply flex space-x-2 overflow-x-auto;
}

.quick-actions-horizontal {
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE/Edge */
}

.quick-actions-horizontal::-webkit-scrollbar {
  display: none; /* Chrome/Safari */
}

.quick-action-compact {
  @apply flex-shrink-0 rounded-lg p-3;
}

.quick-action-compact {
  min-width: max-content;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: white;
  cursor: pointer;
  transition: all 0.2s;
}

.quick-action-compact:hover {
  @apply bg-gray-50;
}

/* Session Progress Indicator - Monochrome + Shimmer for Timeline Cards */
.session-progress-bar {
  @apply relative overflow-hidden bg-slate-100 rounded-full;
  height: 4px;
  width: 60px;
  border: 1px solid theme('colors.slate.200');
  transition: opacity 300ms ease-out;
}

.session-progress-fill {
  @apply absolute inset-y-0 left-0 rounded-full;
  background: linear-gradient(90deg, #60a5fa 0%, #818cf8 50%, #a78bfa 100%);
  transition: width 500ms cubic-bezier(0.4, 0, 0.2, 1);
  animation: shimmer-progress 2s ease-in-out infinite;
  will-change: width;
}

/* Completion animation - smooth fade when progress reaches 100% */
.session-progress-bar[aria-valuenow="100"] {
  animation: progress-complete-fade 300ms ease-out forwards;
}

@keyframes shimmer-progress {
  0%, 100% {
    opacity: 0.8;
    transform: translateZ(0);
    filter: hue-rotate(0deg) saturate(1);
  }
  50% {
    opacity: 1;
    transform: translateZ(0) scale(1.01);
    filter: hue-rotate(5deg) saturate(1.1);
  }
}

@keyframes progress-complete-fade {
  0% {
    opacity: 1;
    transform: translateZ(0) scale(1);
  }
  100% {
    opacity: 0;
    transform: translateZ(0) scale(0.95);
  }
}

/* Reduced motion override - freeze animation but keep progress visible */
@media (prefers-reduced-motion: reduce) {
  .session-progress-fill {
    animation: none !important;
    transition: width 200ms linear !important;
  }
  .session-progress-bar[aria-valuenow="100"] {
    animation: none !important;
    opacity: 0 !important;
  }
}

/* Dot Grid Background Pattern - Professional, Subtle */
.dot-grid-background {
  position: relative;
  background-color: #fafafa;
  background-image: radial-gradient(circle, #e5e7eb 1px, transparent 1px);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
}

/* Darker variant for better contrast */
.dot-grid-background-dark {
  position: relative;
  background-color: #f3f4f6;
  background-image: radial-gradient(circle, #d1d5db 1px, transparent 1px);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
}

/* Lighter variant for subtle effect */
.dot-grid-background-light {
  position: relative;
  background-color: #ffffff;
  background-image: radial-gradient(circle, #f3f4f6 1px, transparent 1px);
  background-size: 24px 24px;
  background-position: 0 0, 12px 12px;
}

/* Dense variant for more prominent effect */
.dot-grid-background-dense {
  position: relative;
  background-color: #fafafa;
  background-image: radial-gradient(circle, #e5e7eb 1.5px, transparent 1.5px);
  background-size: 16px 16px;
  background-position: 0 0, 8px 8px;
}

/* Skeleton Loading Animation */
@keyframes skeleton-pulse {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.animate-skeleton-pulse {
  animation: skeleton-pulse 1.5s ease-in-out infinite;
}

/* Reduced motion override for skeleton */
@media (prefers-reduced-motion: reduce) {
  .animate-skeleton-pulse {
    animation: none !important;
    background: linear-gradient(90deg, #e5e7eb 0%, #f3f4f6 100%);
  }
}
