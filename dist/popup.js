import"./chunks/modulepreload-polyfill.B5Qt9EMX.js";class o{constructor(){this.init()}async init(){this.setupEventListeners(),await this.checkConnectionStatus()}setupEventListeners(){document.getElementById("openSidePanel")?.addEventListener("click",async()=>{try{const e=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];e&&e.id&&(await chrome.sidePanel.open({tabId:e.id}),window.close())}catch(s){console.error("Failed to open side panel:",s)}}),document.getElementById("voiceRecording")?.addEventListener("click",()=>{this.openSidePanelWithFeature("voice")}),document.getElementById("aiProcessing")?.addEventListener("click",()=>{this.openSidePanelWithFeature("ai")}),document.getElementById("emrIntegration")?.addEventListener("click",()=>{this.openSidePanelWithFeature("emr")}),document.getElementById("quickActions")?.addEventListener("click",()=>{this.openSidePanelWithFeature("actions")})}async openSidePanelWithFeature(s){try{const t=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];t&&t.id&&(await chrome.storage.session.set({highlightFeature:s}),await chrome.sidePanel.open({tabId:t.id}),window.close())}catch(e){console.error("Failed to open side panel with feature:",e)}}async checkConnectionStatus(){try{const e=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0],t=document.getElementById("statusIndicator"),a=t.querySelector(".status-dot");if(this.isEMRSite(e?.url))try{const n=await chrome.storage.session.get(["modelStatus","lastStatusCheck"]),i=Date.now()-(n.lastStatusCheck||0);if(n.modelStatus&&i<3e5){const c=n.modelStatus.isConnected,r=n.modelStatus.whisperServer?.running;c||r?(a.className="status-dot status-online",t.lastChild.textContent="Ready for medical dictation"):(a.className="status-dot status-offline",t.lastChild.textContent="Services not connected")}else a.className="status-dot status-offline",t.lastChild.textContent="Status check pending..."}catch(n){console.warn("Failed to get cached status:",n),a.className="status-dot status-offline",t.lastChild.textContent="Status unavailable"}else a.className="status-dot status-offline",t.lastChild.textContent="Navigate to EMR to use"}catch(s){console.error("Failed to check connection status:",s);const e=document.getElementById("statusIndicator"),t=e.querySelector(".status-dot");t.className="status-dot status-offline",e.lastChild.textContent="Connection check failed"}}isEMRSite(s){return s?s.includes("my.xestro.com"):!1}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new o}):new o;
